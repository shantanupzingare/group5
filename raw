Msg 2715, Level 16, State 3, Procedure usp_UpsertStudentData, Line 12
Column, parameter, or variable #1: Cannot find data type StudentDataType.
Parameter or variable '@StudentData' has an invalid data type.
Msg 1087, Level 16, State 1, Procedure usp_UpsertStudentData, Line 17
Must declare the table variable "@StudentData".


create table StudentData(
Id INT PRIMARY KEY,
Name NVARCHAR(100),
Email NVARCHAR(100),
Subject NVARCHAR(100),
Marks INT
);
SELECT * FROM StudentData;


CREATE PROCEDURE usp_UpsertStudentData
@StudentData StudentDataType READONLY
as
Begin
Set NOCOUNT ON;
MERGE INTO STUDENTDATA AS TARGET
USING @STUDENTDATA AS SOURCE
ON TARGET.ID=SOURCE.ID
WHEN MATCHED THEN
UPDATE SET
NAME=SOURCE.NAME,
EMAIL=SOURCE.EMAIL,
SUBJECT=SOURCE.SUBJECT,
MARKS=SOURCE.MARKS
WHEN NOT MATCHED BY TARGET THEN
INSERT(ID,NAME,EMAIL,SUBJECT,MARKS)
VALUES(SOURCE.ID,SOURCE.NAME,SOURCE.EMAIL,SOURCE.SUBJECT,SOURCE.MARKS);
END;



Processing File: StudentData_100k.xlsx
Error processing file 'StudentData_100k.xlsx': The MERGE statement attempted to UPDATE or DELETE the same row more than once. This happens when a target row matches more than one source row. A MERGE statement cannot UPDATE/DELETE the same row of the target table multiple times. Refine the ON clause to ensure a target row matches at most one source row, or use the GROUP BY clause to group the source rows.
Watching folder for new Excel files...
